/*
 scrappit.js
 http://scrappit.org
 Available via the MIT License
 Author: Josh Dzielak, Copyright (c) 2011
*/(function(a,b,c){function C(){o(f)||(z=z(),A(z),z.amd&&w(function(){return z})),setTimeout(B,0)}function B(){if(g){for(var a=0;a<g.length;a++){var b=g[a];o(b)?b():q(b)&&h&&x(b)}f.readyQueue=[]}}function A(b){a[e]=b}function t(){return++j+(new Date).getTime().toString().slice(5)}function s(a){n&&o(n.warn)&&n.warn(a)}function r(a){var b=p(a)?[]:{};for(i in a)a[i]&&q(a[i])?b[i]=r(a[i]):b[i]=a[i];return b}function q(a){return m.call(a)==="[object Object]"}function p(a){return m.call(a)==="[object Array]"}function o(a){return m.call(a)==="[object Function]"}var d="0.1.0",e="scrappit",f=a[e],g=f&&f.readyQueue,h,j=0,k=undefined,l=""+k,m=Object.prototype.toString,n=b.console,u=function(){function e(a,b){for(var c in a)if(a.hasOwnProperty(c))for(var d=0,e=a[c].length;d<e;d++)if(a[c][d].token===b){a[c].splice(d,1);return!0}return!1}function d(a,c,d){a.hasOwnProperty(c)||(a[c]=[]);var e=b();a[c].push({token:e,func:d});return e}function c(a,b,c,d){if(!a.hasOwnProperty(b))return!1;var e=function(){var d=r(a[b]);for(var e=0,f=d.length;e<f;e++){var g=d[e];g&&g.func(c)}};d===!0?e():setTimeout(e,0);return!0}function b(){return(++a).toString()}var a=-1;return function(a){var b=a.messages={};a.publish=function(a,d){return c(b,a,d,!1)},a.publishSync=function(a,d){return c(b,a,d,!0)},a.subscribe=function(a,c){return d(b,a,c)},a.unsubscribe=function(a){return e(b,a)}}}(),v;f&&f.define&&f.define.amd?v=f:v=a;var w=v.define,x=v.require,y=v.requirejs,h=w&&w.amd,z=function(){function g(a){try{a.launch(),b.publish("launch.scrapp",a)}catch(c){n&&(n.error("The launch method of this scrapp threw an exception:"),n.error(a),n.error(c))}}function f(a){if(a.require){if(h){var b={},c=a.require;q(a.require)&&(b=a.require,c=a.require.deps),a.requireDeps(b,c,function(){var b=arguments,c=a.launch;a.launch=function(){c.apply(a,b)},a.onDependenciesReady()})}}else a.onDependenciesReady();return a}function d(a){function f(){a.unsubscribe(c),b.unsubscribe(d)}a._uid=a._uid||a.id||t(),a._deps_context=e+"/"+a._uid+"/deps",u(a),a.requireDeps=function(c,d,e){if(h){var f=a._deps_context;q(c)?c.context=f:(e=d,d=c,c={}),c.context=f,b.require(c,d,e)}},a.onDependenciesReady=function(){g(a)},a.close=function(){a.publish("close")};var c,d;c=a.subscribe("close",function(){f(),b.publish("close.scrapp",a)}),d=b.subscribe("close",function(b){f(),a.close()})}function c(a){d(a),b.publishSync("beforeLaunch.scrapp",a),f(a)}var b=function(a){return c(a)};u(b),b._uid=t();if(b.amd=h)b.define=w,b.require=x,b.requirejs=y;b.close=function(){b.publish("close",b),a[e]=k},b.readyQueue=[];return b};C()})(this,window,document)