/*
 scrappit.js
 http://scrappit.org
 Available via the MIT License
 Author: Josh Dzielak, Copyright (c) 2011
*/(function(a,b,c){function m(a){return j.call(a)==="[object Function]"}function n(a){return j.call(a)==="[object Array]"}function o(a){return j.call(a)==="[object Object]"}function p(a){var b=n(a)?[]:{};for(i in a)a[i]&&o(a[i])?b[i]=p(a[i]):b[i]=a[i];return b}function q(){return++f+(new Date).getTime().toString().slice(5)}function t(){var b=s();typeof define=="function"&&define.amd?define("scrappit",[],function(){return b}):a[e]=b}var d="0.1.1",e="scrappit",f=0,g=undefined,h=""+g,j=Object.prototype.toString,k=b.console,l=a[e],r=function(){function b(){return(++a).toString()}function c(a,b,c,d){if(!a.hasOwnProperty(b))return!1;var e=function(){var d=p(a[b]);for(var e=0,f=d.length;e<f;e++){var g=d[e];g&&g.func(c)}};return d===!0?e():setTimeout(e,0),!0}function d(a,c,d){a.hasOwnProperty(c)||(a[c]=[]);var e=b();return a[c].push({token:e,func:d}),e}function e(a,b){for(var c in a)if(a.hasOwnProperty(c))for(var d=0,e=a[c].length;d<e;d++)if(a[c][d].token===b)return a[c].splice(d,1),!0;return!1}var a=-1;return function(a){var b=a.messages={};a.publish=function(a,d){return c(b,a,d,!1)},a.publishSync=function(a,d){return c(b,a,d,!0)},a.subscribe=function(a,c){return d(b,a,c)},a.unsubscribe=function(a){return e(b,a)}}}(),s=function(){function c(a){d(a),b.publishSync("beforeLaunch.scrapp",a),f(a)}function d(a){function f(){a.unsubscribe(c),b.unsubscribe(d)}a._uid=a._uid||a.id||q(),a._deps_context=e+"/"+a._uid+"/deps",r(a),a.requireDeps=function(b,c,d){if(typeof define=="function"&&define.amd){var e=a._deps_context;o(b)?b.context=e:(d=c,c=b,b={}),b.context=e,require(b,c,d)}},a.applyArgsAndLaunch=function(){var b=arguments,c=a.launch;a.launch=function(){c.apply(a,b)},a.onDependenciesReady()},a.onDependenciesReady=function(){h(a)},a.close=function(){a.publish("close")};var c,d;c=a.subscribe("close",function(){f(),b.publish("close.scrapp",a)}),d=b.subscribe("close",function(b){f(),a.close()})}function f(a){var b=a.require;if(b){var c={},d,e=a.applyArgsAndLaunch;o(b)?(c=b,c.callback||(c.callback=e)):d=b,a.requireDeps(c,d,e)}else a.onDependenciesReady();return a}function h(a){try{a.launch(),b.publish("launch.scrapp",a)}catch(c){k&&k.error&&(k.error("The launch method of this scrapp threw an exception:"),k.error(a),k.error(c))}}function i(){b._uid=q(),r(b),b.close=function(){b.publish("close",b),a[e]=g},b.noConflict=function(){return a[e]=l,b}}var b=function(a){return c(a)};return i(),b};t()})(this,window,document)